{"version":3,"file":"find-release.js","sourceRoot":"/","sources":["find-release.ts"],"names":[],"mappings":";;AAUA,kCA8BC;AAvCD,MAAM,uBAAuB,GAAG,CAAC,CAAC;AAElC;;;;;;GAMG;AACI,KAAK,UAAU,WAAW,CAC/B,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,EAAmB,EAC7C,aAAqB,EACrB,aAAa,GAAG,uBAAuB;IAEvC,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,OAAO,CAAC,IAAI,CAAC;IAErC,MAAM,gBAAgB,GAAG,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAChD,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,YAAY,EAC/B;QACE,KAAK;QACL,IAAI;KACL,CACF,CAAC;IACF,IAAI,WAAW,GAAG,CAAC,CAAC;IACpB,IAAI,KAAK,EAAE,MAAM,KAAK,IAAI,gBAAgB,EAAE,CAAC;QAC3C,MAAM,CAAC,KAAK,CAAC,mCAAmC,WAAW,EAAE,CAAC,CAAC;QAC/D,MAAM,eAAe,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CACrC,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC,QAAQ,KAAK,aAAa,CAChD,CAAC;QACF,IAAI,eAAe,EAAE,CAAC;YACpB,OAAO,eAAe,CAAC;QACzB,CAAC;QACD,IAAI,WAAW,GAAG,aAAa,EAAE,CAAC;YAChC,MAAM,CAAC,KAAK,CAAC,oDAAoD,CAAC,CAAC;YACnE,MAAM;QACR,CAAC;QACD,WAAW,EAAE,CAAC;IAChB,CAAC;IACD,OAAO,IAAI,CAAC;AACd,CAAC","sourcesContent":["import { ContextArgument } from \"./context\";\nconst DEFAULT_MAX_PAGE_SEARCH = 5;\n\n/**\n * Find the release with the given tag name.\n * @param context Context argument\n * @param targetTagName The tag name to search for.\n * @param maxPageSearch The maximum number of pages to search through. Default is 5.\n * @returns The release if found, otherwise null.\n */\nexport async function findRelease(\n  { octokit, context, logger }: ContextArgument,\n  targetTagName: string,\n  maxPageSearch = DEFAULT_MAX_PAGE_SEARCH\n) {\n  const { owner, repo } = context.repo;\n\n  const releasesIterator = octokit.paginate.iterator(\n    octokit.rest.repos.listReleases,\n    {\n      owner,\n      repo,\n    }\n  );\n  let currentPage = 1;\n  for await (const value of releasesIterator) {\n    logger.debug(`Searching through release page #${currentPage}`);\n    const matchingRelease = value.data.find(\n      (release) => release.tag_name === targetTagName\n    );\n    if (matchingRelease) {\n      return matchingRelease;\n    }\n    if (currentPage > maxPageSearch) {\n      logger.debug(`Reached maximum page size when searching, aborting`);\n      break;\n    }\n    currentPage++;\n  }\n  return null;\n}\n"]}